<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Analyzing Categorical Data in R: The Chi-Square test</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #000">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../05-chisquare-test.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Analyzing Categorical Data in R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Analyzing Categorical Data in R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Analyzing Categorical Data in R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 62%" class="percentage">
    62%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 62%" aria-valuenow="62" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../05-chisquare-test.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction to Categorical Data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-effect-size.html">2. Quantifying association</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-visualization.html">3. Visualizing categorical data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-distributions.html">4. Sampling schemes and probabilities</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. The Chi-Square test
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#a-hypothesis-test-for-independence">A hypothesis test for independence</a></li>
<li><a href="#expected-counts-under-then-null-hypothesis">Expected counts under then null hypothesis</a></li>
<li><a href="#the-chi-square-statistic">The Chi-square statistic</a></li>
<li><a href="#the-chi-square-test-in-r">The Chi-square test in R</a></li>
<li><a href="#when-to-apply">When to apply</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-power.html">6. Categorical data and statistical power</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-biology.html">7. Complications with biological data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/04-distributions.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/06-power.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/04-distributions.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Sampling schemes and
        </a>
        <a class="chapter-link float-end" href="../instructor/06-power.html" rel="next">
          Next: Categorical data and... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>The Chi-Square test</h1>
        <p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/05-chisquare-test.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 10 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What are the null and alternative hypothesis of the chi-square
test?</li>
<li>What are the expected counts under the null hypothesis?</li>
<li>What is the test statistic for the chi-square test?</li>
<li>How can I run the chi-square test in R?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Understand the principle behind the chisquare test.</li>
<li>Be able to apply the chisquare test in R.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="a-hypothesis-test-for-independence"><h2 class="section-heading">A hypothesis test for independence<a class="anchor" aria-label="anchor" href="#a-hypothesis-test-for-independence"></a>
</h2>
<hr class="half-width"><p>So far, we have learned that</p>
<ul><li>in a <span class="math inline">\(2\times 2\)</span> contingency
table, we tabulate the counts according to two variables.</li>
<li>We are usually interested in whether the two variables are
associated.</li>
<li>If the variables are associated, they should not follow the
probability rules for independence.</li>
</ul><p>If we’d like to set up a hypothesis test for whether the two
varilables are associated, then we have to formulate a null hypothesis,
and then calculate the probability of the observed counts under this
hypothesis.</p>
<p>Let’s start with the null and alternative hypothesis. The
<strong>null hypothesis</strong> is that the two variables are
<strong>independent</strong>.<br>
If we can reject the null hypothesis, we will take on the
<strong>alternative hypothesis</strong> is that the two variables are
<strong>associated</strong>.</p>
</section><section id="expected-counts-under-then-null-hypothesis"><h2 class="section-heading">Expected counts under then null hypothesis<a class="anchor" aria-label="anchor" href="#expected-counts-under-then-null-hypothesis"></a>
</h2>
<hr class="half-width"><p>In the chi-square test, which tests the above hypothesis, we start by
calculating the expected counts under the null hypothesis, and then
check how far the actual data are away from the expectation.</p>
<p>For this, we need to calculate the <em>marginal frequencies</em> of
the outcomes of each variable. Remember, the marginal frequencies could
also be translated as the <em>overall</em> frequency of this
outcome.</p>
<figure><img src="../fig/marginal-probabilities.png" width="600" class="figure mx-auto d-block"></figure><p>The marginal frequencies are our estimate for the true <em>marginal
probabilities</em>, which is why they are noted as <span class="math inline">\(\hat{P}\)</span> (p hat). Remember that the hat
indicates that the quantity below the hat is an estimate.</p>
<p>In the exposure/disease example, we can calculate the estimate for
the marginal disease probability as</p>
<p><span class="math display">\[\hat{P}(\text{disease}) =
\frac{n_{11}+n_{21}}{n_{\cdot\cdot}}.\]</span></p>
<p>This means we take the total number of diseased mice in the
experiment (those that have been exposed, and those that haven’t been)
and divide it by the total number of mice in the experiment. In other
words, we calculate the proportion of mice with disease, ignoring that
some of them have been exposed to the chemical and others haven’t.</p>
<p>Likewise we can calculate the marginal proportion of exposed mice
as</p>
<p><span class="math display">\[\hat{P}(\text{exposed}) = \frac{n_{11} +
n_{12}}{n_{\cdot\cdot}},\]</span> meaning we divide the number of all
exposed mice (ignoring whether they contracted the disease) by the total
number of mice in the experiment.</p>
<p>Let’s add some numbers to this:</p>
<figure><img src="../fig/marginal-probabilities-2.png" width="500" class="figure mx-auto d-block"></figure><p>In the above table, I’ve added the marginal totals on the sides (I
think that’s where the term “marginal” comes from). We see that, in
total, 100 out of the 200 mice were exposed to the chemical (by design
of the experiment), which gives a marginal proportion of <span class="math display">\[\hat{P}(\text{exposure})=\frac{100}{200}=0.5\]</span>
of exposed mice. On the other hand, ignoring exposure, 14 out the 200
mice caught the disease during the experiment, giving an estimated
marginal probability of</p>
<p><span class="math display">\[\hat{P}(\text{disease})=\frac{14}{200}=0.07.\]</span></p>
<p>Now, the key point is that we estimated the probabilities of exposure
and disease, while <em>ignoring</em> the respective other variable –
which is exactly what’s valid to do when the two variables are not
associated. So, assuming the null hypothesis is true and the variables
are in fact nor associated, we can use these estimated probabilities and
apply the probability rule for independence to calculate the estimated
counts under the null.</p>
<p>For example, the expected count for exposed, diseased mice is</p>
<p><span class="math display">\[E(n_{11}) = \hat{P}(\text{exposed})
\cdot \hat{P}(\text{disease}) \cdot n_{\cdot\cdot} = 0.5 \cdot 0.07
\cdot 200 = 7.\]</span></p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge1"></a>
</h3>
<div class="callout-content">
<p>Can you calculate the expected count for non-exposed diseased mice
under the assumption of independence?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p><span class="math display">\[E_{22} = \hat{P}(\text{non-exposed})
\cdot \hat{P}(\text{healthy}) \cdot n_{\cdot\cdot} = 0.5 \cdot 0.93
\cdot 200 = 93\]</span></p>
</div>
</div>
</div>
</div>
</section><section id="the-chi-square-statistic"><h2 class="section-heading">The Chi-square statistic<a class="anchor" aria-label="anchor" href="#the-chi-square-statistic"></a>
</h2>
<hr class="half-width"><p>If we have expected counts under the assumption of independence, the
natural thing to do is compare them with the <strong>actual</strong>
counts. For a hypothesis test, we’d like to have the probability of the
observed counts under the assumption of independence, which is one
value, while we have four counts. Therefore, in the chi-square test, the
discrepancy between observed and expected counts is summarized into one
<em>statistic</em> called <span class="math inline">\(\chi^2\)</span>
(chi square):</p>
<p><span class="math display">\[\chi^2 =
\sum_{ij}\frac{(O_{ij}-E_{ij})^2}{E_{ij}}\]</span></p>
<p>where</p>
<ul><li>
<span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are the row and column indices,</li>
<li>
<span class="math inline">\(O\)</span> is the observed count,
and</li>
<li>
<span class="math inline">\(E\)</span> is the expected count.</li>
</ul><p>The value <span class="math inline">\(\chi^2\)</span> is the sum of
squares of the differences between observed and expected counts,
normalized by the expected counts, and it <strong>quantifies the
deviation from independence</strong>.</p>
<p>Now we need the probability of the <span class="math inline">\(\chi^2\)</span> calculated from our data under the
assumption of independence. To find a <strong>null distribution</strong>
for <span class="math inline">\(\chi^2\)</span>, you could repeatedly
simulate data from a model in which the two variables are independent,
and then compare the observed value to the resulting distribution. Since
in the previous lessons, we haven’t yet learned how to do this, we’ll
stick with textbook knowledge for now:</p>
<p>The textbook tells us that the <em>test statistic</em> <span class="math inline">\(\chi^2\)</span> follows a so-called <span class="math inline">\(\chi^2\)</span> distribution (just like the
t-statistic follows a t-distribution) with <span class="math inline">\((r-1)\cdot(r-2)\)</span> degrees of freedom, where
<span class="math inline">\(r\)</span> and <span class="math inline">\(c\)</span> are the numbers of rows and columns in
the contingency table, respectively.</p>
</section><section id="the-chi-square-test-in-r"><h2 class="section-heading">The Chi-square test in R<a class="anchor" aria-label="anchor" href="#the-chi-square-test-in-r"></a>
</h2>
<hr class="half-width"><p>Let’s look at some results in practice. The test itself is really
just one line of code.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">chisq.test</span><span class="op">(</span><span class="va">mytable</span>, correct<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pearson's Chi-squared test

data:  mytable
X-squared = 2.765, df = 1, p-value = 0.09635</code></pre>
</div>
<p>The output is also rather compact. We learn that R has calculated a
value for <span class="math inline">\(\chi^2=2.765\)</span>.<br><code>df=1</code> tells us that it has compared this value to a <span class="math inline">\(\chi^2\)</span>-distribution with one degree of
freedom. <code>p-value = 0.09635</code> means that the probability of
observing a <span class="math inline">\(\chi^2\geq 2.765\)</span> is
around 10%.</p>
<p>We could also perform this calculation ourselves:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pchisq</span><span class="op">(</span><span class="fl">2.765</span>,df<span class="op">=</span><span class="fl">1</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.09634669</code></pre>
</div>
<p><strong>Conclusion:</strong> The difference in proportions of
diseased mice are not significantly different in the exposure and
no-exposure groups.</p>
<p>As a reminder: This doesn’t mean that exposure and disease are not
associated, but that the data doesn’t hold enough evidence for a
potential association, at a significance level of <span class="math inline">\(\alpha=0.05\)</span>.</p>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<p>Look into the help for the <code>chisq.test</code> function. Why is
there no option to choose between a one-sided and a two-sided test?</p>
</div>
</div>
</div>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h3>
<div class="callout-content">
<p>In the function call to <code>chisq.test</code>, we used the argument
<code>correct=FALSE</code>. This argument determines whether or not
<em>Yates continuity correction</em> is used. If you want to learn more
about it, have a look <a href="https://en.wikipedia.org/wiki/Yates%27s_correction_for_continuity" class="external-link">here</a>.
My suggested default is to not use it.</p>
</div>
</div>
</div>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge2"></a>
</h3>
<div class="callout-content">
<p>Assign the output of the <code>chisq.test</code> function call to a
variable, and apply the <code>names</code> function on it. Can you look
at the expected counts for the exposure/disease table?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mytest</span> <span class="op">&lt;-</span> <span class="fu">chisq.test</span><span class="op">(</span><span class="va">mytable</span>, correct <span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">names</span><span class="op">(</span><span class="va">mytest</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "statistic" "parameter" "p.value"   "method"    "data.name" "observed" 
[7] "expected"  "residuals" "stdres"   </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mytest</span><span class="op">$</span><span class="va">expected</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            diseased healthy
non-exposed        7      93
exposed            7      93</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="when-to-apply"><h2 class="section-heading">When to apply<a class="anchor" aria-label="anchor" href="#when-to-apply"></a>
</h2>
<hr class="half-width"><p>The <span class="math inline">\(\chi^2\)</span> test is applicable to
2-dimensional contingency tables for testing the hypothesis of
independence.</p>
<ul><li>It assumes that all observations are independent (one observation is
an event that leads to the count in one cell being increased by 1).</li>
<li>A rule of thumb is that the expected values of all cells in the
contingency table should be &gt;5 in at least 80% of the cells, and the
expected cells should not be &lt;1 in any of the cells. If this isn’t
the case, an alternative is Fisher’s exact test (see <a href="06-power.html">next episode</a>).</li>
</ul><!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 --></section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/04-distributions.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/06-power.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/04-distributions.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Sampling schemes and
        </a>
        <a class="chapter-link float-end" href="../instructor/06-power.html" rel="next">
          Next: Categorical data and... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/05-chisquare-test.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries/workbench-template-rmd/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:sarah.kaspar@embl.de">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.3" class="external-link">sandpaper (0.16.3)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.4" class="external-link">pegboard (0.7.4)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-rmd/instructor/05-chisquare-test.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "statistics, data, lesson, software",
  "name": "The Chi-Square test",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-rmd/instructor/05-chisquare-test.html",
  "identifier": "https://carpentries.github.io/workbench-template-rmd/instructor/05-chisquare-test.html",
  "dateCreated": "2023-09-08",
  "dateModified": "2024-03-12",
  "datePublished": "2024-03-26"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

