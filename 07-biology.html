<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Analyzing Categorical Data in R: Complications with biological data</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png"><link rel="manifest" href="favicons/incubator/site.webmanifest"><link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/07-biology.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Analyzing Categorical Data in R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Analyzing Categorical Data in R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Analyzing Categorical Data in R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 88%" class="percentage">
    88%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 88%" aria-valuenow="88" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/07-biology.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction to Categorical Data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-effect-size.html">2. Quantifying association</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-visualization.html">3. Visualizing categorical data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-distributions.html">4. Sampling schemes and probabilities</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-chisquare-test.html">5. The Chi-Square test</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-power.html">6. Categorical data and statistical power</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        7. Complications with biological data
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#overview">Overview</a></li>
<li><a href="#larger-tables">Larger tables</a></li>
<li><a href="#d-tables">3D tables</a></li>
<li><a href="#three-way-interactions">Three-way interactions</a></li>
<li><a href="#additional-variance">Additional variance</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="06-power.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="06-power.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Categorical data and
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Complications with biological data</h1>
        <p>Last updated on 2025-03-03 |

        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/07-biology.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>When are Fisher- and Chisquare test not applicable for biological
data?</li>
<li>What are alternative methods?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain overdispersion and how it can lead to false positives.<br></li>
<li>Explain random effects.</li>
<li>Name some alternative methods.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<hr class="half-width"><p>The lesson has been using a very simple example to illustrate the
principles behind analyzing categorical data.</p>
<p>Of course, biological data are often more complex than can be
captured by a <span class="math inline">\(2\times2\)</span> table.</p>
<p>Some examples for this are:</p>
<ul><li>There are more than two categories per variable. For instance, 3
different treatments are applied on cultured cells, and individual cells
are subsequently categorized into 4 mutually exclusive phenotypes.</li>
<li>There are more than two variables. For instance, the above
experiments could have been carried out in three replicates, such that
replicate is the third variable. We are looking for an effect that is
consistent across replicates.</li>
</ul></section><section><h2 class="section-heading" id="larger-tables">Larger tables<a class="anchor" aria-label="anchor" href="#larger-tables"></a></h2>
<hr class="half-width"><p>Let’s start with the first example, where 3 different treatments are
applied on cultured cells, and individual cells are subsequently
categorized into 4 mutually exclusive phenotypes. The resulting
contingency table could look like this:</p>
<table class="table"><thead><tr class="header"><th align="left"></th>
<th align="center">round</th>
<th align="center">spiky</th>
<th align="center">stretched</th>
<th align="center">flat</th>
</tr></thead><tbody><tr class="odd"><td align="left">treatment 1</td>
<td align="center">5</td>
<td align="center">15</td>
<td align="center">30</td>
<td align="center">3</td>
</tr><tr class="even"><td align="left">treatment 2</td>
<td align="center">10</td>
<td align="center">37</td>
<td align="center">21</td>
<td align="center">29</td>
</tr><tr class="odd"><td align="left">treatment 3</td>
<td align="center">1</td>
<td align="center">40</td>
<td align="center">0</td>
<td align="center">14</td>
</tr></tbody></table><div class="section level3">
<h3 id="how-to-visualize-the-proportions">How to visualize the proportions?<a class="anchor" aria-label="anchor" href="#how-to-visualize-the-proportions"></a></h3>
<p>We can still use mosaic plots to visualize the proportions:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cell_shapes</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">5</span>,<span class="fl">15</span>,<span class="fl">30</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">10</span>,<span class="fl">37</span>,<span class="fl">21</span>,<span class="fl">29</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">40</span>,<span class="fl">0</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">rownames</span><span class="op">(</span><span class="va">cell_shapes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"treatment 1"</span>,<span class="st">"treatment 2"</span>, <span class="st">"treatment 3"</span><span class="op">)</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="va">cell_shapes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"round"</span>, <span class="st">"spiky"</span>, <span class="st">"stretched"</span>, <span class="st">"flat"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mosaicplot</span><span class="op">(</span><span class="va">cell_shapes</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/07-biology-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="for-the-brave" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="for-the-brave" class="callout-inner">
<h3 class="callout-title">For the brave</h3>
<div class="callout-content">
<p>Can you turn the <code>cell_shapes</code> table into tidy data, and
make a mosaic plot with <code>ggplot2</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The tricky part is data wrangling:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidy_shapes</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span><span class="va">cell_shapes</span>, treatment<span class="op">=</span><span class="fu">c</span><span class="op">(</span><span class="st">"treatment1"</span>, <span class="st">"traetment2"</span>,<span class="st">"treatment3"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"shape"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tidy_shapes</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 12 × 3
   treatment  shape     count
   &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;
 1 treatment1 round         5
 2 treatment1 spiky        15
 3 treatment1 stretched    30
 4 treatment1 flat          3
 5 traetment2 round        10
 6 traetment2 spiky        37
 7 traetment2 stretched    21
 8 traetment2 flat         29
 9 treatment3 round         1
10 treatment3 spiky        40
11 treatment3 stretched     0
12 treatment3 flat         14</code></pre>
</div>
<p>For plotting, all you need to do is exchange the variable names from
the instructions in <a href="03-visualization.html#using-ggplot2">episode 3</a>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidy_shapes</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>sumcount <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">treatment</span>, y <span class="op">=</span> <span class="va">count</span>, fill<span class="op">=</span><span class="va">shape</span>, width<span class="op">=</span><span class="va">sumcount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_grid</span><span class="op">(</span><span class="op">~</span><span class="va">treatment</span>, scales <span class="op">=</span> <span class="st">"free_x"</span>, space <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_void</span><span class="op">(</span><span class="op">)</span> </span></code></pre>
</div>
<p><img src="fig/07-biology-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure">
Looks much nicer, doesn’t it?</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="what-are-suitable-measures-for-association">What are suitable measures for association?<a class="anchor" aria-label="anchor" href="#what-are-suitable-measures-for-association"></a></h3>
<p>All the <a href="02-effect-size.html">measures</a> you learned about
are require a <span class="math inline">\(2\times2\)</span> table. The
good news is that you can subset or summarize your <span class="math inline">\(4\times3\)</span> table into smaller tables and
calculate odds ratios or differences in proportions on them.</p>
<p>For example, you could compare treatment 2 and 3 with regards to the
ratio of flat and round cells. For this, you <strong>subset</strong> the
table to the relevant rows and columns:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shapes_subset</span> <span class="op">&lt;-</span> <span class="va">cell_shapes</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,<span class="fu">c</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">shapes_subset</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            round flat
treatment 2    10   29
treatment 3     1   14</code></pre>
</div>
<p>The odds for being round (vs. flat) in treatment 2 compared to
treatment 3 are:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">10</span><span class="op">/</span><span class="fl">29</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">14</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.827586</code></pre>
</div>
<p>If you are rather interested in the overall proportion of round
cells, still comparing treatment 2 and 3, you can
<strong>subset</strong> the columns and <strong>summarize</strong> some
of the rows:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">round</span> <span class="op">&lt;-</span> <span class="va">cell_shapes</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="va">others</span> <span class="op">&lt;-</span> <span class="va">cell_shapes</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="va">rowSums</span></span>
<span></span>
<span><span class="va">shapes_summary</span> <span class="op">&lt;-</span> <span class="fu">cbind</span><span class="op">(</span><span class="va">round</span>,<span class="va">others</span><span class="op">)</span></span>
<span><span class="va">shapes_summary</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>            round others
treatment 2    10     87
treatment 3     1     54</code></pre>
</div>
<p>Now you can compare the proportions of round cells between the
treatments 2 and 3:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">10</span><span class="op">/</span><span class="op">(</span><span class="fl">10</span><span class="op">+</span><span class="fl">87</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">54</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 5.670103</code></pre>
</div>
<p>The proportion of round cells is 5 times higher in the experiment
with treatment 2.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>You probably noticed that with larger tables, you have many more
options of sub-setting or summarizing them into <span class="math inline">\(2\times2\)</span> tables. Think carefully about
your research question and then decide which comparison you’d like to
make.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="how-to-calculate-significance">How to calculate significance?<a class="anchor" aria-label="anchor" href="#how-to-calculate-significance"></a></h3>
<p>As soon as you have subset or summarized your larger table into a
<span class="math inline">\(2\times2\)</span> one, you can apply the
standard Fisher or <span class="math inline">\(\chi^2\)</span> test on
it, and we’ll come back to this very soon.</p>
<p>But luckily, Fisher’s exact test and the <span class="math inline">\(\chi^2\)</span> test can also be applied to 2D
tables with more than two categories in each dimension, and this should
actually be the first step in your hypothesis testing workflow.</p>
<p>A Fisher test on the above <span class="math inline">\(3\times
4\)</span> table will answer the following question: <strong>Is there a
difference in phenotype composition between the three
treatments?</strong></p>
<p>This is an overall question and it’s controlling for the family-wise
error rate. If this test comes out significant, it tells you that under
the assumption that phenotype and treatment are not associated in any
way (i.e. for each phenotype, the underlying proportion doesn’t vary
between treatments), your results are very unlikely.</p>
<p>For the above example, the <span class="math inline">\(\chi^2\)</span> test is clearly significant:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">chisq.test</span><span class="op">(</span><span class="va">cell_shapes</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in chisq.test(cell_shapes): Chi-squared approximation may be incorrect</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Pearson's Chi-squared test

data:  cell_shapes
X-squared = 62.024, df = 6, p-value = 1.744e-11</code></pre>
</div>
<p>Now you could do follow-up tests in order to find out which
phenotypes are different in their proportions between treatments, for
example:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fisher.test</span><span class="op">(</span><span class="va">shapes_summary</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Fisher's Exact Test for Count Data

data:  shapes_summary
p-value = 0.05797
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
   0.8335549 273.9339822
sample estimates:
odds ratio
  6.154128 </code></pre>
</div>
<p>Just as for calculating measures of association, you should ask
yourself what information you’re after, before running 10 or more
individual comparisons.</p>
</div>
</section><section><h2 class="section-heading" id="d-tables">3D tables<a class="anchor" aria-label="anchor" href="#d-tables"></a></h2>
<hr class="half-width"><p>For higher-dimensional tables, life gets yet a bit more complicated.
Again, there are different ways of analyzing them, dependent on your
research question. We’ll look at two examples.</p>
<div class="section level3">
<h3 id="conditional-independence">Conditional independence<a class="anchor" aria-label="anchor" href="#conditional-independence"></a></h3>
<p>Let’s assume we have a reduced version of the above experiment, where
control and treatment are compared with respect to the number of cells
that are “round” or “not round”.</p>
<p>A resulting table might look like this:</p>
<table class="table"><thead><tr class="header"><th align="left"></th>
<th align="center">round</th>
<th align="center">other</th>
</tr></thead><tbody><tr class="odd"><td align="left">ctrl</td>
<td align="center">16</td>
<td align="center">39</td>
</tr><tr class="even"><td align="left">trt</td>
<td align="center">21</td>
<td align="center">42</td>
</tr></tbody></table><p>This still looks familiar. But now, the biologist at work was
concerned about the reproducibiliy of the experiment, so she performed
it twice. And as a result, we look at a 3-dimensional table:</p>
<table class="table"><caption>replicate 1</caption>
<thead><tr class="header"><th align="left"></th>
<th align="center">round</th>
<th align="center">other</th>
</tr></thead><tbody><tr class="odd"><td align="left">ctrl</td>
<td align="center">16</td>
<td align="center">39</td>
</tr><tr class="even"><td align="left">trt</td>
<td align="center">21</td>
<td align="center">42</td>
</tr></tbody></table><table class="table"><caption>replicate 2</caption>
<thead><tr class="header"><th align="left"></th>
<th align="center">round</th>
<th align="center">other</th>
</tr></thead><tbody><tr class="odd"><td align="left">ctrl</td>
<td align="center">35</td>
<td align="center">89</td>
</tr><tr class="even"><td align="left">trt</td>
<td align="center">51</td>
<td align="center">99</td>
</tr></tbody></table><div class="section level4">
<h4 id="how-to-create-a-3-d-table-in-r">How to create a 3-D table in R<a class="anchor" aria-label="anchor" href="#how-to-create-a-3-d-table-in-r"></a></h4>
<p>For analyzing this data, we need to code it up. In R, this can be
done as follows.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep1</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">16</span>, <span class="fl">39</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">21</span>,<span class="fl">42</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rep2</span> <span class="op">&lt;-</span> <span class="fu">rbind</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">35</span>, <span class="fl">89</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">51</span>,<span class="fl">99</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table3d</span> <span class="op">&lt;-</span> <span class="fu">array</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="va">rep1</span>, <span class="va">rep2</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">table3d</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>, , 1

     [,1] [,2]
[1,]   16   39
[2,]   21   42

, , 2

     [,1] [,2]
[1,]   35   89
[2,]   51   99</code></pre>
</div>
<div id="discussion" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="discussion" class="callout-inner">
<h3 class="callout-title">Discussion</h3>
<div class="callout-content">
<p>We could easily bring the above scenario down to a classical <span class="math inline">\(2\times2\)</span> table by pooling the counts
across replicates. What could be problematic about this approach?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>The replicate might have an effect on the row and column sums. Have a
look at the Simpson’s paradox.</p>
</div>
</div>
</div>
</div>
<div id="lets-try-it" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="lets-try-it" class="callout-inner">
<h3 class="callout-title">Let’s try it</h3>
<div class="callout-content">
<p>Use the above code for creating an array and sum up the counts across
replicates.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rowSums</span><span class="op">(</span><span class="va">table3d</span>, dims<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     [,1] [,2]
[1,]   51  128
[2,]   72  141</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>To avoid the danger of replicate that are confounded with a variable
of interest, one can stratify by replicate. Stratify means: split the
analysis by replicate, and then combine the results.</p>
<p>This is what the <em>Cochran-Mantel-Haenszel test</em> does. It
calculates</p>
<ul><li>a <em>common odds ratio</em> and</li>
<li>a modified chi-square,</li>
</ul><p>taking the replicates into account.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="three-way-interactions">Three-way interactions<a class="anchor" aria-label="anchor" href="#three-way-interactions"></a></h2>
<hr class="half-width"><p>Refer to Poisson models</p>
</section><section><h2 class="section-heading" id="additional-variance">Additional variance<a class="anchor" aria-label="anchor" href="#additional-variance"></a></h2>
<hr class="half-width"><p>When we’re using Fisher’s or <span class="math inline">\(\chi^2\)</span> test, we model the data as having
been obtained from a particular sampling scheme, like Poisson, binomial
or multinomial sampling. These assume that there is an underlying rate,
or probability, at which events occur, and which doesn’t vary. For
example, we could say that patients show up at a hospital at an average
rate of 16 patients per day (<span class="math inline">\(\lambda=16\)</span>), and if we took 5 samples at
5 different days, we’d assume the same Poisson rate for each day. The
counts would vary from day to day, but with a variance of <span class="math inline">\(var=\lambda\)</span>, which is the expected
randomness for a Poisson counting process. See also <a href="https://sarahkaspar.github.io/biostatistics-course/05-Poisson.html" class="external-link">the
lesson on distributions</a>.</p>
<p>The problem is, that in biology, we often have experiments where we
deal with additional variance that can’t be explained by the normal
variance that’s inherent to Poisson counting. For example, if we model
read counts from RNA sequencing, it turns out that the (residual)
variance is much higher than <span class="math inline">\(\lambda\)</span>, because the expression of a
particular gene usually depends on more factors than just the
experimentally controlled condition(s). It is also influenced by
additional biological and possibly technical variance, such that the
counts vary considerably between replicates.</p>
<div class="section level3">
<h3 id="so-what">So what?<a class="anchor" aria-label="anchor" href="#so-what"></a></h3>
<p>What happens if we still analyze these data with methods that assume
Poisson variance? This increases the risk for false positives.
Intuitively speaking, the increased variance can produce high counts in
one or more of the cells, leading to higher proportions than would be
expected by change under the assumption of independence and Poisson
sampling. So the Fisher test can mistake noise for a difference in
proportions.</p>
</div>
<div class="section level3">
<h3 id="what-to-do">What to do?<a class="anchor" aria-label="anchor" href="#what-to-do"></a></h3>
<p>First of all, think about the data that you’re looking at, and how
they were produced. If you have several replicates, you have a chance to
estimate the variance in your data. In a typical <span class="math inline">\(2\times2\)</span> table, you just have one count
per cell, and a different condition in each cell, so there is no chance
to infer the variance from looking at the data. In this case you have to
ask yourself, whether it’s likely that you’re overlooking additional
variance, and be aware that the data might not perfectly match the
assumptions of your test, so don’t over-interpret the p-value that you
get – which is always a good advice.</p>
<p>If you do have several counts per condition, you can consider to
model your data using a generalized linear model of the negative
binomial family. This is outside the scope of this lesson.</p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="06-power.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="06-power.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Categorical data and
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/07-biology.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries/workbench-template-rmd/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:sarah.kaspar@embl.de">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-rmd/07-biology.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "statistics, data, lesson, software",
  "name": "Complications with biological data",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-rmd/07-biology.html",
  "identifier": "https://carpentries.github.io/workbench-template-rmd/07-biology.html",
  "dateCreated": "2025-03-03",
  "dateModified": "2025-03-03",
  "datePublished": "2025-03-03"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

